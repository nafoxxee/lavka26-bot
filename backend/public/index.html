<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Lavka26 - –û–±—ä—è–≤–ª–µ–Ω–∏—è</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="style.css?v=4">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <!-- –í–ï–†–•–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ -->
        <header class="app-header">
            <div class="header-left">
                <button class="header-btn back-btn" id="back-btn" onclick="goBack()" style="display: none;">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <div class="app-title" id="header-title">Lavka26</div>
            </div>
            <div class="header-right">
                <button class="header-btn" onclick="switchTab('profile')">
                    <i class="fas fa-user"></i>
                </button>
            </div>
        </header>

        <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ -->
        <main class="app-content">
            <!-- –ì–ª–∞–≤–Ω–∞—è: –õ–µ–Ω—Ç–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π -->
            <div class="tab-content active" id="feed-tab">
                <!-- –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ -->
                <div class="search-section">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" id="search-input" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –∏ —É—Å–ª—É–≥">
                        <button class="search-btn" onclick="performSearch()">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <!-- –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—Å–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
                    <div class="category-filter" id="category-filter" style="display: none;">
                        <select class="category-select" id="search-category">
                            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                            <option value="transport">üöó –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</option>
                            <option value="electronics">üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</option>
                            <option value="property">üè† –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</option>
                            <option value="clothing">üëï –û–¥–µ–∂–¥–∞</option>
                            <option value="jobs">üíº –†–∞–±–æ—Ç–∞</option>
                            <option value="services">üîß –£—Å–ª—É–≥–∏</option>
                            <option value="animals">üêæ –ñ–∏–≤–æ—Ç–Ω—ã–µ</option>
                            <option value="other">üì¶ –ü—Ä–æ—á–µ–µ</option>
                        </select>
                    </div>
                </div>

                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                <div class="categories-section">
                    <div class="categories-grid">
                        <div class="category-item" onclick="filterByCategory('transport')">
                            <i class="fas fa-car"></i>
                            <span>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</span>
                        </div>
                        <div class="category-item" onclick="filterByCategory('electronics')">
                            <i class="fas fa-mobile"></i>
                            <span>–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</span>
                        </div>
                        <div class="category-item" onclick="filterByCategory('property')">
                            <i class="fas fa-home"></i>
                            <span>–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</span>
                        </div>
                        <div class="category-item" onclick="filterByCategory('clothing')">
                            <i class="fas fa-tshirt"></i>
                            <span>–û–¥–µ–∂–¥–∞</span>
                        </div>
                        <div class="category-item" onclick="filterByCategory('jobs')">
                            <i class="fas fa-briefcase"></i>
                            <span>–†–∞–±–æ—Ç–∞</span>
                        </div>
                        <div class="category-item" onclick="filterByCategory('services')">
                            <i class="fas fa-tools"></i>
                            <span>–£—Å–ª—É–≥–∏</span>
                        </div>
                        <div class="category-item" onclick="filterByCategory('animals')">
                            <i class="fas fa-paw"></i>
                            <span>–ñ–∏–≤–æ—Ç–Ω—ã–µ</span>
                        </div>
                        <div class="category-item" onclick="filterByCategory('other')">
                            <i class="fas fa-box"></i>
                            <span>–ü—Ä–æ—á–µ–µ</span>
                        </div>
                    </div>
                </div>

                <!-- –°–ø–∏—Å–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π -->
                <div class="ads-section">
                    <div class="ads-grid" id="ads-grid">
                        <div class="loading-placeholder">
                            <div class="skeleton-card"></div>
                            <div class="skeleton-card"></div>
                            <div class="skeleton-card"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ò–∑–±—Ä–∞–Ω–Ω–æ–µ -->
            <div class="tab-content" id="favorites-tab" style="display: none;">
                <div class="ads-grid" id="favorites-grid">
                    <div class="empty-state">
                        <i class="fas fa-heart"></i>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π</p>
                    </div>
                </div>
            </div>

            <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
            <div class="tab-content" id="messages-tab" style="display: none;">
                <div class="messages-list" id="messages-list">
                    <div class="empty-state">
                        <i class="fas fa-comment"></i>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</p>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
            <div class="tab-content" id="profile-tab" style="display: none;">
                <div class="profile-section">
                    <div class="profile-header">
                        <div class="profile-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="profile-info">
                            <h2 id="profile-name">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
                            <p id="profile-phone">+7 XXX XXX-XX-XX</p>
                        </div>
                    </div>
                    
                    <div class="profile-stats">
                        <div class="stat-item">
                            <span class="stat-number" id="user-ads-count">0</span>
                            <span class="stat-label">–û–±—ä—è–≤–ª–µ–Ω–∏–π</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="user-favorites-count">0</span>
                            <span class="stat-label">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
                        </div>
                    </div>

                    <div class="profile-menu">
                        <button class="menu-item" onclick="switchTab('my-ads')">
                            <i class="fas fa-list"></i>
                            <span>–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</span>
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        <button class="menu-item" onclick="showEditProfile()">
                            <i class="fas fa-edit"></i>
                            <span>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</span>
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        <button class="menu-item" onclick="showSettings()">
                            <i class="fas fa-cog"></i>
                            <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        <button class="menu-item" onclick="showAbout()">
                            <i class="fas fa-info-circle"></i>
                            <span>–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</span>
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- –ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
            <div class="tab-content" id="my-ads-tab" style="display: none;">
                <div class="my-ads-header">
                    <div class="my-ads-tabs">
                        <button class="my-ads-tab-btn active" onclick="showMyAdsSection('active')">
                            <span>–ê–∫—Ç–∏–≤–Ω—ã–µ</span>
                        </button>
                        <button class="my-ads-tab-btn" onclick="showMyAdsSection('archived')">
                            <span>–ê—Ä—Ö–∏–≤</span>
                        </button>
                    </div>
                    <button class="create-ad-btn" onclick="openCreateAd()">
                        <i class="fas fa-plus"></i>
                        <span>–°–æ–∑–¥–∞—Ç—å</span>
                    </button>
                </div>
                
                <div class="my-ads-section" id="my-ads-active">
                    <div class="ads-grid" id="my-ads-grid">
                        <div class="loading-placeholder">
                            <div class="skeleton-card"></div>
                            <div class="skeleton-card"></div>
                        </div>
                    </div>
                </div>
                
                <div class="my-ads-section" id="my-ads-archived" style="display: none;">
                    <div class="ads-grid" id="my-ads-archived-grid">
                        <div class="loading-placeholder">
                            <div class="skeleton-card"></div>
                            <div class="skeleton-card"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ê–¥–º–∏–Ω—Å–∫–∞—è –ø–∞–Ω–µ–ª—å -->
            <div class="tab-content" id="admin-tab" style="display: none;">
                <div class="admin-tabs">
                    <button class="admin-tab-btn active" onclick="showAdminSection('pending')">
                        <i class="fas fa-clock"></i>
                        <span>–ú–æ–¥–µ—Ä–∞—Ü–∏—è</span>
                    </button>
                    <button class="admin-tab-btn" onclick="showAdminSection('support')">
                        <i class="fas fa-headset"></i>
                        <span>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</span>
                    </button>
                    <button class="admin-tab-btn" onclick="showAdminSection('payments')">
                        <i class="fas fa-credit-card"></i>
                        <span>–ü–ª–∞—Ç–µ–∂–∏</span>
                    </button>
                    <button class="admin-tab-btn" onclick="showAdminSection('users')">
                        <i class="fas fa-users"></i>
                        <span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</span>
                    </button>
                </div>

                <div class="admin-section" id="admin-pending">
                    <div class="admin-content" id="pending-ads-list">
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π...</p>
                    </div>
                </div>

                <div class="admin-section" id="admin-support" style="display: none;">
                    <h3>üéß –ó–∞–ø—Ä–æ—Å—ã –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</h3>
                    <div class="admin-content">
                        <p>–ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É: 0</p>
                    </div>
                </div>

                <div class="admin-section" id="admin-payments" style="display: none;">
                    <h3>üí≥ –ü–ª–∞—Ç–µ–∂–∏</h3>
                    <div class="admin-content">
                        <p>–ü–ª–∞—Ç–µ–∂–µ–π: 0</p>
                    </div>
                </div>

                <div class="admin-section" id="admin-users" style="display: none;">
                    <h3>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                    <div class="admin-content">
                        <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 0</p>
                    </div>
                </div>
            </div>
        </main>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="tabbar" id="main-tabbar">
            <button class="tabbar-item active" data-tab="feed" onclick="switchTab('feed')">
                <i class="fas fa-home"></i>
                <span>–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            <button class="tabbar-item" data-tab="favorites" onclick="switchTab('favorites')">
                <i class="fas fa-heart"></i>
                <span>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
            </button>
            <button class="tabbar-item" data-tab="messages" onclick="switchTab('messages')">
                <i class="fas fa-comment"></i>
                <span>–°–æ–æ–±—â–µ–Ω–∏—è</span>
            </button>
            <button class="tabbar-item" data-tab="profile" onclick="switchTab('profile')">
                <i class="fas fa-user"></i>
                <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
            </button>
        </nav>

        <!-- –ê–¥–º–∏–Ω—Å–∫–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="tabbar admin-tabbar" id="admin-tabbar" style="display: none;">
            <button class="tabbar-item active" data-tab="feed" onclick="switchTab('feed')">
                <i class="fas fa-home"></i>
                <span>–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            <button class="tabbar-item" data-tab="favorites" onclick="switchTab('favorites')">
                <i class="fas fa-heart"></i>
                <span>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
            </button>
            <button class="tabbar-item" data-tab="messages" onclick="switchTab('messages')">
                <i class="fas fa-comment"></i>
                <span>–°–æ–æ–±—â–µ–Ω–∏—è</span>
            </button>
            <button class="tabbar-item" data-tab="admin" onclick="switchTab('admin')">
                <i class="fas fa-shield-alt"></i>
                <span>–ú–æ–¥–µ—Ä–∞—Ü–∏—è</span>
            </button>
        </nav>

        <!-- –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
        <button class="fab-button" id="create-button" onclick="openCreateAd()">
            <i class="fas fa-plus"></i>
        </button>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
        <div class="modal" id="create-ad-modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="back-btn" onclick="closeModal()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h2>–°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</h2>
                </div>
                <div class="modal-body">
                    <form id="create-ad-form">
                        <div class="form-group">
                            <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—è *</label>
                            <input type="text" id="ad-title" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: iPhone 13 Pro Max">
                        </div>
                        <div class="form-group">
                            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                            <select id="ad-category" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                                <option value="transport">üöó –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</option>
                                <option value="electronics">üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</option>
                                <option value="property">üè† –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</option>
                                <option value="clothing">üëï –û–¥–µ–∂–¥–∞</option>
                                <option value="jobs">üíº –†–∞–±–æ—Ç–∞</option>
                                <option value="services">üîß –£—Å–ª—É–≥–∏</option>
                                <option value="animals">üêæ –ñ–∏–≤–æ—Ç–Ω—ã–µ</option>
                                <option value="other">üì¶ –ü—Ä–æ—á–µ–µ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>–¶–µ–Ω–∞</label>
                            <div class="price-input">
                                <input type="number" id="ad-price" placeholder="0">
                                <span class="currency">‚ÇΩ</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>–û–ø–∏—Å–∞–Ω–∏–µ *</label>
                            <textarea id="ad-description" rows="4" required placeholder="–û–ø–∏—à–∏—Ç–µ —Ç–æ–≤–∞—Ä –ø–æ–¥—Ä–æ–±–Ω–æ: —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–¥–∞–∂–∏..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ *</label>
                            <div class="location-section">
                                <button type="button" class="location-btn" onclick="getLocation()">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</span>
                                </button>
                                <div class="location-divider">–∏–ª–∏</div>
                                <input type="text" id="ad-location" placeholder="–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, –¥. 1" required>
                                <div class="location-suggestions" id="location-suggestions" style="display: none;">
                                    <div class="suggestion-item" onclick="selectLocation('–≥. –ú–æ—Å–∫–≤–∞, –ö—Ä–∞—Å–Ω–∞—è –ø–ª–æ—â–∞–¥—å')">–≥. –ú–æ—Å–∫–≤–∞, –ö—Ä–∞—Å–Ω–∞—è –ø–ª–æ—â–∞–¥—å</div>
                                    <div class="suggestion-item" onclick="selectLocation('–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ù–µ–≤—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç')">–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ù–µ–≤—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç</div>
                                    <div class="suggestion-item" onclick="selectLocation('–≥. –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫, –ö—Ä–∞—Å–Ω—ã–π –ø—Ä–æ—Å–ø–µ–∫—Ç')">–≥. –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫, –ö—Ä–∞—Å–Ω—ã–π –ø—Ä–æ—Å–ø–µ–∫—Ç</div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</label>
                            <div class="photo-upload-area">
                                <input type="file" id="ad-photos" accept="image/*" multiple style="display: none;" onchange="handlePhotos(event)">
                                <div class="photo-grid" id="photo-grid">
                                    <div class="add-photo-btn" onclick="document.getElementById('ad-photos').click()">
                                        <i class="fas fa-camera"></i>
                                        <span>–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω *</label>
                            <input type="tel" id="ad-phone" placeholder="+7 XXX XXX-XX-XX" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn-primary" onclick="submitAd()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
        <div class="modal" id="edit-profile-modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="back-btn" onclick="closeEditProfile()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h2>
                </div>
                <div class="modal-body">
                    <form id="edit-profile-form">
                        <div class="form-group">
                            <label>–ò–º—è *</label>
                            <input type="text" id="profile-name-input" required placeholder="–í–∞—à–µ –∏–º—è">
                        </div>
                        <div class="form-group">
                            <label>–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                            <input type="tel" id="profile-phone-input" required placeholder="+7 XXX XXX-XX-XX">
                        </div>
                        <div class="form-group">
                            <label>–û —Å–µ–±–µ</label>
                            <textarea id="profile-bio-input" rows="3" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeEditProfile()">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn-primary" onclick="saveProfile()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
        <div class="modal" id="reject-modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="back-btn" onclick="closeRejectModal()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h2>–û—Ç–∫–ª–æ–Ω–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</h2>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è *</label>
                        <select id="reject-reason-select" onchange="updateRejectReason()">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É</option>
                            <option value="–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª">–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª —Å–µ—Ä–≤–∏—Å–∞</option>
                            <option value="–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏">–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏</option>
                            <option value="–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ñ–æ—Ç–æ">–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</option>
                            <option value="–ù–µ–ø–æ–¥—Ö–æ–¥—è—â–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è">–ù–µ–ø–æ–¥—Ö–æ–¥—è—â–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è</option>
                            <option value="–°–ø–∞–º">–°–ø–∞–º –∏–ª–∏ —Ä–µ–∫–ª–∞–º–∞</option>
                            <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –∞–≤—Ç–æ—Ä–∞ *</label>
                        <textarea id="reject-comment" rows="4" placeholder="–£–∫–∞–∂–∏—Ç–µ, —á—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeRejectModal()">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn-danger" onclick="confirmReject()">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
        <div class="notifications" id="notifications"></div>
    </div>

    <script src="app.js?v=4"></script>
    <script>
        // –ü–û–õ–ù–´–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ - –ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–ù–ê–Ø –†–ê–ë–û–¢–ê
        console.log('üöÄ Lavka26 v4 - –ü–û–õ–ù–´–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ');
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentUser = null;
        let ads = [];
        let navigationHistory = ['feed'];
        let currentFilter = {
            search: '',
            category: '',
            sort: 'newest'
        };
        let currentRejectAdId = null;
        
        const API_BASE = 'https://lavka26-backend-rmr1.onrender.com/api';
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üì± DOM –∑–∞–≥—Ä—É–∂–µ–Ω');
            initApp();
        });
        
        function initApp() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready();
                window.Telegram.WebApp.expand();
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–∫–∏ –Ω–∞–∑–∞–¥
                window.Telegram.WebApp.BackButton.onClick(() => {
                    goBack();
                });
                
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                currentUser = window.Telegram.WebApp.initDataUnsafe?.user;
                if (currentUser) {
                    console.log('üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Telegram:', currentUser);
                    checkAdmin();
                }
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            loadAds();
            setupEventListeners();
            
            console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
        }
        
        function setupEventListeners() {
            // –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞
            const searchInput = document.getElementById('search-input');
            const searchCategory = document.getElementById('search-category');
            const categoryFilter = document.getElementById('category-filter');
            
            if (searchInput) {
                searchInput.addEventListener('focus', function() {
                    if (categoryFilter) {
                        categoryFilter.style.display = 'block';
                    }
                });
                
                let searchTimeout;
                searchInput.addEventListener('input', function() {
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(() => {
                        currentFilter.search = this.value;
                        currentFilter.category = searchCategory ? searchCategory.value : '';
                        loadAds();
                    }, 500);
                });
            }
            
            if (searchCategory) {
                searchCategory.addEventListener('change', function() {
                    currentFilter.category = this.value;
                    loadAds();
                });
            }
        }
        
        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        function switchTab(tabName) {
            console.log('üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞:', tabName);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
            if (navigationHistory[navigationHistory.length - 1] !== tabName) {
                navigationHistory.push(tabName);
            }
            
            updateHeader(tabName);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å
            document.querySelectorAll('.tabbar-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            const tabElement = document.getElementById(tabName + '-tab');
            if (tabElement) {
                tabElement.style.display = 'block';
            }
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            const activeBtn = document.querySelector(`.tabbar-item[data-tab="${tabName}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            switch(tabName) {
                case 'favorites':
                    loadFavorites();
                    break;
                case 'my-ads':
                    loadMyAds();
                    break;
                case 'profile':
                    loadProfile();
                    break;
                case 'admin':
                    if (currentUser && currentUser.id === 379036860) {
                        loadAdminPanel();
                    }
                    break;
            }
        }
        
        function updateHeader(tabName) {
            const headerTitle = document.getElementById('header-title');
            const backBtn = document.getElementById('back-btn');
            
            if (headerTitle) {
                const titles = {
                    'feed': 'Lavka26',
                    'favorites': '–ò–∑–±—Ä–∞–Ω–Ω–æ–µ',
                    'messages': '–°–æ–æ–±—â–µ–Ω–∏—è',
                    'profile': '–ü—Ä–æ—Ñ–∏–ª—å',
                    'my-ads': '–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è',
                    'admin': '–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å'
                };
                headerTitle.textContent = titles[tabName] || 'Lavka26';
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥
            if (backBtn) {
                if (navigationHistory.length > 1) {
                    backBtn.style.display = 'flex';
                    if (window.Telegram && window.Telegram.WebApp) {
                        window.Telegram.WebApp.BackButton.show();
                    }
                } else {
                    backBtn.style.display = 'none';
                    if (window.Telegram && window.Telegram.WebApp) {
                        window.Telegram.WebApp.BackButton.hide();
                    }
                }
            }
        }
        
        function goBack() {
            if (navigationHistory.length > 1) {
                navigationHistory.pop();
                const previousTab = navigationHistory[navigationHistory.length - 1];
                switchTab(previousTab);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        async function loadAds() {
            const adsList = document.getElementById('ads-grid');
            if (!adsList) return;
            
            adsList.innerHTML = `
                <div class="loading-placeholder">
                    <div class="skeleton-card"></div>
                    <div class="skeleton-card"></div>
                    <div class="skeleton-card"></div>
                </div>
            `;
            
            try {
                const params = new URLSearchParams();
                if (currentFilter.category) params.append('category', currentFilter.category);
                if (currentFilter.search) params.append('search', currentFilter.search);
                
                const response = await fetch(`${API_BASE}/ads?${params}`);
                if (response.ok) {
                    ads = await response.json();
                    renderAds(ads);
                } else {
                    // –ï—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —á—Ç–æ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π
                    console.warn('API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫');
                    renderAds([]);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π:', error);
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á—Ç–æ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π –≤–º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏
                renderAds([]);
            }
        }
        
        function renderAds(adsToRender) {
            const adsList = document.getElementById('ads-grid');
            if (!adsList) return;
            
            if (adsToRender.length === 0) {
                adsList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-search"></i>
                        <p>–û–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
                        <small>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã</small>
                    </div>
                `;
                return;
            }
            
            adsList.innerHTML = adsToRender.map(ad => `
                <div class="ad-card" onclick="openAd(${ad.id})">
                    <div class="ad-image">
                        ${ad.photo ? `<img src="${ad.photo}" alt="${ad.title}">` : '<i class="fas fa-image"></i>'}
                    </div>
                    <div class="ad-info">
                        <h3 class="ad-title">${ad.title}</h3>
                        <div class="ad-price">${ad.price ? ad.price + ' ‚ÇΩ' : '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è'}</div>
                        <div class="ad-location">
                            <i class="fas fa-map-marker-alt"></i>
                            ${ad.location || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
                        </div>
                        <div class="ad-date">${formatDate(ad.created_at)}</div>
                    </div>
                </div>
            `).join('');
        }
        
        // –ê–¥–º–∏–Ω—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function checkAdmin() {
            if (currentUser && currentUser.id === 379036860) {
                console.log('üõ°Ô∏è –ê–¥–º–∏–Ω detected');
                const adminTabbar = document.getElementById('admin-tabbar');
                if (adminTabbar) {
                    adminTabbar.style.display = 'flex';
                }
            }
        }
        
        function showAdminSection(section) {
            console.log('üõ°Ô∏è –ê–¥–º–∏–Ω —Å–µ–∫—Ü–∏—è:', section);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
            document.querySelectorAll('.admin-section').forEach(sec => {
                sec.style.display = 'none';
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å
            document.querySelectorAll('.admin-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
            const targetSection = document.getElementById(`admin-${section}`);
            if (targetSection) {
                targetSection.style.display = 'block';
            }
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            if (event && event.target) {
                const btn = event.target.closest('.admin-tab-btn');
                if (btn) btn.classList.add('active');
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            switch(section) {
                case 'pending':
                    refreshPendingAds();
                    break;
                case 'support':
                    refreshSupportMessages();
                    break;
                case 'payments':
                    refreshPayments();
                    break;
                case 'users':
                    refreshUsers();
                    break;
            }
        }
        
        function refreshPendingAds() {
            console.log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏');
            
            const pendingAdsList = document.getElementById('pending-ads-list');
            if (!pendingAdsList) return;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏–∑ localStorage
            const pendingAds = JSON.parse(localStorage.getItem('pendingAds') || '[]');
            
            if (pendingAds.length === 0) {
                pendingAdsList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-clock"></i>
                        <p>–ù–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</p>
                    </div>
                `;
                return;
            }
            
            pendingAdsList.innerHTML = pendingAds.map(ad => `
                <div class="pending-ad-card" id="pending-ad-${ad.id}">
                    <div class="pending-ad-header">
                        <div class="pending-ad-title">${ad.title}</div>
                        <div class="pending-ad-meta">
                            <span class="category-badge">${getCategoryName(ad.category)}</span>
                            <span class="price-badge">${ad.price}</span>
                        </div>
                    </div>
                    
                    <div class="pending-ad-content">
                        <div class="pending-ad-photos">
                            ${ad.photos && ad.photos.length > 0 ? 
                                ad.photos.slice(0, 3).map(photo => `
                                    <img src="${photo}" alt="–§–æ—Ç–æ" onclick="viewPhoto('${photo}')">
                                `).join('') : 
                                '<div class="no-photos"><i class="fas fa-image"></i></div>'
                            }
                        </div>
                        
                        <div class="pending-ad-info">
                            <div class="description">${ad.description}</div>
                            
                            <div class="ad-details">
                                <div class="detail-item">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>${ad.location}</span>
                                </div>
                                <div class="detail-item">
                                    <i class="fas fa-phone"></i>
                                    <span>${ad.phone}</span>
                                </div>
                                <div class="detail-item">
                                    <i class="fas fa-user"></i>
                                    <span>${ad.user_name}</span>
                                </div>
                                <div class="detail-item">
                                    <i class="fas fa-calendar"></i>
                                    <span>${formatDate(ad.created_at)}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="pending-ad-actions">
                        <button class="btn-approve" onclick="approveAd(${ad.id})">
                            <i class="fas fa-check"></i>
                            <span>–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</span>
                        </button>
                        <button class="btn-reject" onclick="showRejectModal(${ad.id})">
                            <i class="fas fa-times"></i>
                            <span>–û—Ç–∫–ª–æ–Ω–∏—Ç—å</span>
                        </button>
                    </div>
                </div>
            `).join('');
        }
        
        function getCategoryName(category) {
            const categories = {
                'transport': 'üöó –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç',
                'electronics': 'üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞',
                'property': 'üè† –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å',
                'clothing': 'üëï –û–¥–µ–∂–¥–∞',
                'jobs': 'üíº –†–∞–±–æ—Ç–∞',
                'services': 'üîß –£—Å–ª—É–≥–∏',
                'animals': 'üêæ –ñ–∏–≤–æ—Ç–Ω—ã–µ',
                'other': 'üì¶ –ü—Ä–æ—á–µ–µ'
            };
            return categories[category] || category;
        }
        
        function approveAd(adId) {
            console.log('‚úÖ –û–¥–æ–±—Ä–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è:', adId);
            
            // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –≤ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ
            let pendingAds = JSON.parse(localStorage.getItem('pendingAds') || '[]');
            let approvedAds = JSON.parse(localStorage.getItem('approvedAds') || '[]');
            
            const adIndex = pendingAds.findIndex(ad => ad.id === adId);
            if (adIndex !== -1) {
                const ad = pendingAds[adIndex];
                ad.status = 'approved';
                ad.approved_at = new Date().toISOString();
                
                approvedAds.push(ad);
                pendingAds.splice(adIndex, 1);
                
                localStorage.setItem('pendingAds', JSON.stringify(pendingAds));
                localStorage.setItem('approvedAds', JSON.stringify(approvedAds));
                
                showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ', 'success');
                refreshPendingAds();
            }
        }
        
        function showRejectModal(adId) {
            currentRejectAdId = adId;
            const modal = document.getElementById('reject-modal');
            if (modal) {
                modal.style.display = 'flex';
                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('reject-reason-select').value = '';
                document.getElementById('reject-comment').value = '';
            }
        }
        
        function closeRejectModal() {
            const modal = document.getElementById('reject-modal');
            if (modal) {
                modal.style.display = 'none';
                currentRejectAdId = null;
            }
        }
        
        function updateRejectReason() {
            const select = document.getElementById('reject-reason-select');
            const comment = document.getElementById('reject-comment');
            
            const reasons = {
                '–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª': '–í–∞—à–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ —Å–µ—Ä–≤–∏—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å —É—Å–ª–æ–≤–∏—è–º–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è.',
                '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏': '–í –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.',
                '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ñ–æ—Ç–æ': '–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–ª–∏ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç–æ–≤–∞—Ä—É. –î–æ–±–∞–≤—å—Ç–µ —á–µ—Ç–∫–∏–µ —Ñ–æ—Ç–æ.',
                '–ù–µ–ø–æ–¥—Ö–æ–¥—è—â–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è': '–û–±—ä—è–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—â–µ–Ω–æ –≤ –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é.',
                '–°–ø–∞–º': '–û–±—ä—è–≤–ª–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∞–º –∏–ª–∏ —Ä–µ–∫–ª–∞–º—É. –†–∞–∑–º–µ—â–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è.',
                '–î—Ä—É–≥–æ–µ': ''
            };
            
            if (reasons[select.value]) {
                comment.value = reasons[select.value];
            }
        }
        
        function confirmReject() {
            const reason = document.getElementById('reject-reason-select').value;
            const comment = document.getElementById('reject-comment').value;
            
            if (!reason || !comment.trim()) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –∏ –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π', 'error');
                return;
            }
            
            rejectAd(currentRejectAdId, `${reason}: ${comment}`);
            closeRejectModal();
        }
        
        function rejectAd(adId, reason) {
            console.log('‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è:', adId, reason);
            
            let pendingAds = JSON.parse(localStorage.getItem('pendingAds') || '[]');
            let rejectedAds = JSON.parse(localStorage.getItem('rejectedAds') || '[]');
            
            const adIndex = pendingAds.findIndex(ad => ad.id === adId);
            if (adIndex !== -1) {
                const ad = pendingAds[adIndex];
                ad.status = 'rejected';
                ad.rejected_at = new Date().toISOString();
                ad.reject_reason = reason;
                
                rejectedAds.push(ad);
                pendingAds.splice(adIndex, 1);
                
                localStorage.setItem('pendingAds', JSON.stringify(pendingAds));
                localStorage.setItem('rejectedAds', JSON.stringify(rejectedAds));
                
                showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ –∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–æ –∞–≤—Ç–æ—Ä—É', 'error');
                refreshPendingAds();
            }
        }
        
        function viewPhoto(photoUrl) {
            // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–æ—Ç–æ
            const modal = document.createElement('div');
            modal.className = 'photo-modal';
            modal.innerHTML = `
                <div class="photo-modal-content">
                    <button class="photo-modal-close" onclick="this.closest('.photo-modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                    <img src="${photoUrl}" alt="–§–æ—Ç–æ">
                </div>
            `;
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                cursor: pointer;
            `;
            
            const content = modal.querySelector('.photo-modal-content');
            content.style.cssText = `
                position: relative;
                max-width: 90%;
                max-height: 90%;
            `;
            
            const closeBtn = modal.querySelector('.photo-modal-close');
            closeBtn.style.cssText = `
                position: absolute;
                top: -40px;
                right: 0;
                background: rgba(255, 255, 255, 0.2);
                border: none;
                color: white;
                width: 32px;
                height: 32px;
                border-radius: 50%;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
            `;
            
            const img = modal.querySelector('img');
            img.style.cssText = `
                max-width: 100%;
                max-height: 80vh;
                border-radius: 8px;
            `;
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
            
            document.body.appendChild(modal);
        }
        
        function refreshSupportMessages() {
            console.log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏');
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
        }
        
        function refreshPayments() {
            console.log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π');
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
        }
        
        function refreshUsers() {
            console.log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π');
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
        }
        
        // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
        function openCreateAd() {
            const modal = document.getElementById('create-ad-modal');
            if (modal) {
                modal.style.display = 'flex';
                showNotification('–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è', 'info');
            }
        }
        
        function closeModal() {
            const modal = document.getElementById('create-ad-modal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        // –ü–æ–∏—Å–∫
        function performSearch() {
            const searchInput = document.getElementById('search-input');
            const searchCategory = document.getElementById('search-category');
            
            if (searchInput) {
                currentFilter.search = searchInput.value;
            }
            if (searchCategory) {
                currentFilter.category = searchCategory.value;
            }
            
            loadAds();
            showNotification('–ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω', 'success');
        }
        
        // –£—Ç–∏–ª–∏—Ç—ã
        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diff = now - date;
            const hours = Math.floor(diff / (1000 * 60 * 60));
            
            if (hours < 1) {
                const minutes = Math.floor(diff / (1000 * 60));
                return minutes + ' –º–∏–Ω –Ω–∞–∑–∞–¥';
            } else if (hours < 24) {
                return hours + ' —á –Ω–∞–∑–∞–¥';
            } else {
                const days = Math.floor(hours / 24);
                return days + ' –¥ –Ω–∞–∑–∞–¥';
            }
        }
        
        function showNotification(message, type = 'info') {
            const notifications = document.getElementById('notifications');
            if (!notifications) return;
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            notifications.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // –ó–∞–≥–ª—É—à–∫–∏ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π
        function loadFavorites() {
            console.log('üì• –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ');
        }
        
        function loadMyAds() {
            console.log('üì• –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π');
            showMyAdsSection('active');
        }
        
        function showMyAdsSection(section) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å
            document.querySelectorAll('.my-ads-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
            document.querySelectorAll('.my-ads-section').forEach(sec => {
                sec.style.display = 'none';
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
            const targetSection = document.getElementById(`my-ads-${section}`);
            if (targetSection) {
                targetSection.style.display = 'block';
            }
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            const activeBtn = document.querySelector(`.my-ads-tab-btn:nth-child(${section === 'active' ? 1 : 2})`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            if (section === 'active') {
                loadActiveAds();
            } else if (section === 'archived') {
                loadArchivedAds();
            }
        }
        
        function loadActiveAds() {
            const myAdsGrid = document.getElementById('my-ads-grid');
            if (!myAdsGrid) return;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const approvedAds = JSON.parse(localStorage.getItem('approvedAds') || '[]');
            const pendingAds = JSON.parse(localStorage.getItem('pendingAds') || '[]');
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userActiveAds = [
                ...approvedAds.filter(ad => ad.user_id === currentUser?.id),
                ...pendingAds.filter(ad => ad.user_id === currentUser?.id)
            ];
            
            if (userActiveAds.length === 0) {
                myAdsGrid.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-list"></i>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π</p>
                        <button class="btn-primary" onclick="openCreateAd()">–°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</button>
                    </div>
                `;
                return;
            }
            
            myAdsGrid.innerHTML = userActiveAds.map(ad => `
                <div class="ad-card ${ad.status === 'pending' ? 'pending' : ''}" onclick="openAd(${ad.id})">
                    <div class="ad-image">
                        ${ad.photos && ad.photos.length > 0 ? `<img src="${ad.photos[0]}" alt="${ad.title}">` : '<i class="fas fa-image"></i>'}
                        ${ad.status === 'pending' ? '<div class="status-badge pending">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</div>' : ''}
                    </div>
                    <div class="ad-info">
                        <h3 class="ad-title">${ad.title}</h3>
                        <div class="ad-price">${ad.price || '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è'}</div>
                        <div class="ad-location">
                            <i class="fas fa-map-marker-alt"></i>
                            ${ad.location}
                        </div>
                        <div class="ad-date">${formatDate(ad.created_at)}</div>
                    </div>
                </div>
            `).join('');
        }
        
        function loadArchivedAds() {
            const archivedGrid = document.getElementById('my-ads-archived-grid');
            if (!archivedGrid) return;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const rejectedAds = JSON.parse(localStorage.getItem('rejectedAds') || '[]');
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userRejectedAds = rejectedAds.filter(ad => ad.user_id === currentUser?.id);
            
            if (userRejectedAds.length === 0) {
                archivedGrid.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-archive"></i>
                        <p>–í –∞—Ä—Ö–∏–≤–µ –ø–æ–∫–∞ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π</p>
                    </div>
                `;
                return;
            }
            
            archivedGrid.innerHTML = userRejectedAds.map(ad => `
                <div class="ad-card rejected" onclick="openRejectedAd(${ad.id})">
                    <div class="ad-image">
                        ${ad.photos && ad.photos.length > 0 ? `<img src="${ad.photos[0]}" alt="${ad.title}">` : '<i class="fas fa-image"></i>'}
                        <div class="status-badge rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</div>
                    </div>
                    <div class="ad-info">
                        <h3 class="ad-title">${ad.title}</h3>
                        <div class="ad-price">${ad.price || '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è'}</div>
                        <div class="reject-reason">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>${ad.reject_reason}</span>
                        </div>
                        <div class="ad-date">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ ${formatDate(ad.rejected_at)}</div>
                    </div>
                </div>
            `).join('');
        }
        
        function openRejectedAd(adId) {
            const rejectedAds = JSON.parse(localStorage.getItem('rejectedAds') || '[]');
            const ad = rejectedAds.find(a => a.id === adId);
            
            if (ad) {
                showNotification(`–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è: ${ad.reject_reason}`, 'error');
            }
        }
        
        function loadProfile() {
            console.log('üì• –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è –∏–∑ localStorage
            const profileData = JSON.parse(localStorage.getItem('userProfile') || '{}');
            
            // –ï—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç Telegram, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö
            if (currentUser) {
                profileData.name = profileData.name || currentUser.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                profileData.phone = profileData.phone || '';
                profileData.bio = profileData.bio || '';
                profileData.telegram_id = currentUser.id;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            const profileName = document.getElementById('profile-name');
            const profilePhone = document.getElementById('profile-phone');
            
            if (profileName) {
                profileName.textContent = profileData.name || '–ó–∞–≥—Ä—É–∑–∫–∞...';
            }
            if (profilePhone) {
                profilePhone.textContent = profileData.phone || '+7 XXX XXX-XX-XX';
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
            window.userProfile = profileData;
        }
        
        function showEditProfile() {
            console.log('‚úèÔ∏è –û—Ç–∫—Ä—ã—Ç–∏–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è');
            
            const modal = document.getElementById('edit-profile-modal');
            if (!modal) return;
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É —Ç–µ–∫—É—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            const profileData = window.userProfile || {};
            
            const nameInput = document.getElementById('profile-name-input');
            const phoneInput = document.getElementById('profile-phone-input');
            const bioInput = document.getElementById('profile-bio-input');
            
            if (nameInput) nameInput.value = profileData.name || '';
            if (phoneInput) phoneInput.value = profileData.phone || '';
            if (bioInput) bioInput.value = profileData.bio || '';
            
            modal.style.display = 'flex';
        }
        
        function closeEditProfile() {
            const modal = document.getElementById('edit-profile-modal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        function saveProfile() {
            console.log('üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è');
            
            const nameInput = document.getElementById('profile-name-input');
            const phoneInput = document.getElementById('profile-phone-input');
            const bioInput = document.getElementById('profile-bio-input');
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è
            if (!nameInput?.value.trim() || !phoneInput?.value.trim()) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è
            const profileData = {
                ...window.userProfile,
                name: nameInput.value.trim(),
                phone: phoneInput.value.trim(),
                bio: bioInput.value.trim(),
                updated_at: new Date().toISOString()
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('userProfile', JSON.stringify(profileData));
            window.userProfile = profileData;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            const profileName = document.getElementById('profile-name');
            const profilePhone = document.getElementById('profile-phone');
            
            if (profileName) profileName.textContent = profileData.name;
            if (profilePhone) profilePhone.textContent = profileData.phone;
            
            showNotification('–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
            closeEditProfile();
        }
        
        function showSettings() {
            console.log('‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏');
        }
        
        function showAbout() {
            console.log('‚ÑπÔ∏è –û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏');
        }
        
        function submitAd() {
            console.log('üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è');
            
            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
            const title = document.getElementById('ad-title').value;
            const category = document.getElementById('ad-category').value;
            const price = document.getElementById('ad-price').value;
            const description = document.getElementById('ad-description').value;
            const location = document.getElementById('ad-location').value;
            const phone = document.getElementById('ad-phone').value;
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è
            if (!title || !category || !description || !location || !phone) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è
            const adData = {
                title: title,
                category: category,
                price: price || '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è',
                description: description,
                location: location,
                phone: phone,
                photos: uploadedPhotos.map(p => p.url),
                user_id: currentUser?.id || 'anonymous',
                user_name: currentUser?.first_name || '–ê–Ω–æ–Ω–∏–º',
                created_at: new Date().toISOString(),
                status: 'pending' // –ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
            };
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            sendAdToModeration(adData);
        }
        
        function sendAdToModeration(adData) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            showNotification('–û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é...', 'info');
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            const pendingAds = JSON.parse(localStorage.getItem('pendingAds') || '[]');
            adData.id = Date.now();
            pendingAds.push(adData);
            localStorage.setItem('pendingAds', JSON.stringify(pendingAds));
            
            console.log('‚úÖ –û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é:', adData);
            
            showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é', 'success');
            closeModal();
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('create-ad-form').reset();
            uploadedPhotos = [];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–æ—Ç–æ —Å–µ—Ç–∫—É
            const photoGrid = document.getElementById('photo-grid');
            if (photoGrid) {
                photoGrid.innerHTML = `
                    <div class="add-photo-btn" onclick="document.getElementById('ad-photos').click()">
                        <i class="fas fa-camera"></i>
                        <span>–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</span>
                    </div>
                `;
            }
            
            // –ï—Å–ª–∏ –∞–¥–º–∏–Ω, –æ–±–Ω–æ–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏
            if (currentUser && currentUser.id === 379036860) {
                refreshPendingAds();
            }
        }
        
        // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
        function getLocation() {
            console.log('üìç –ó–∞–ø—Ä–æ—Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏');
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        
                        // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞—Ç–Ω–æ–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
                        const locationInput = document.getElementById('ad-location');
                        if (locationInput) {
                            locationInput.value = `${lat.toFixed(6)}, ${lon.toFixed(6)}`;
                            showNotification('–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ', 'success');
                        }
                    },
                    (error) => {
                        console.error('–û—à–∏–±–∫–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏:', error);
                        showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ', 'error');
                    }
                );
            } else {
                showNotification('–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', 'error');
            }
        }
        
        function selectLocation(address) {
            const locationInput = document.getElementById('ad-location');
            if (locationInput) {
                locationInput.value = address;
            }
            
            const suggestions = document.getElementById('location-suggestions');
            if (suggestions) {
                suggestions.style.display = 'none';
            }
        }
        
        // –§–æ—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∞
        let uploadedPhotos = [];
        
        function handlePhotos(event) {
            const files = event.target.files;
            const photoGrid = document.getElementById('photo-grid');
            
            if (!photoGrid) return;
            
            Array.from(files).forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        const photoId = Date.now() + Math.random();
                        uploadedPhotos.push({
                            id: photoId,
                            url: e.target.result,
                            file: file
                        });
                        
                        const photoItem = document.createElement('div');
                        photoItem.className = 'photo-item';
                        photoItem.innerHTML = `
                            <img src="${e.target.result}" alt="–§–æ—Ç–æ">
                            <button class="remove-photo" onclick="removePhoto(${photoId})">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                        
                        // –í—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–¥ –∫–Ω–æ–ø–∫–æ–π –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
                        const addBtn = photoGrid.querySelector('.add-photo-btn');
                        if (addBtn) {
                            photoGrid.insertBefore(photoItem, addBtn);
                        }
                    };
                    
                    reader.readAsDataURL(file);
                }
            });
            
            // –û—á–∏—â–∞–µ–º input –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Ö –∂–µ —Ñ–∞–π–ª–æ–≤
            event.target.value = '';
        }
        
        function removePhoto(photoId) {
            uploadedPhotos = uploadedPhotos.filter(photo => photo.id !== photoId);
            
            const photoGrid = document.getElementById('photo-grid');
            if (photoGrid) {
                const photoItems = photoGrid.querySelectorAll('.photo-item');
                photoItems.forEach(item => {
                    const removeBtn = item.querySelector('.remove-photo');
                    if (removeBtn && removeBtn.getAttribute('onclick').includes(photoId)) {
                        item.remove();
                    }
                });
            }
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∞–¥—Ä–µ—Å–∞ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
        document.addEventListener('DOMContentLoaded', function() {
            const locationInput = document.getElementById('ad-location');
            const suggestions = document.getElementById('location-suggestions');
            
            if (locationInput && suggestions) {
                locationInput.addEventListener('focus', function() {
                    if (this.value.length === 0) {
                        suggestions.style.display = 'block';
                    }
                });
                
                locationInput.addEventListener('input', function() {
                    if (this.value.length > 0) {
                        suggestions.style.display = 'none';
                    } else {
                        suggestions.style.display = 'block';
                    }
                });
                
                locationInput.addEventListener('blur', function() {
                    setTimeout(() => {
                        suggestions.style.display = 'none';
                    }, 200);
                });
            }
        });
        
        // –≠–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–π
        window.switchTab = switchTab;
        window.goBack = goBack;
        window.performSearch = performSearch;
        window.showAdminSection = showAdminSection;
        window.openCreateAd = openCreateAd;
        window.closeModal = closeModal;
        window.filterByCategory = filterByCategory;
        window.openAd = openAd;
        window.showEditProfile = showEditProfile;
        window.closeEditProfile = closeEditProfile;
        window.saveProfile = saveProfile;
        window.showSettings = showSettings;
        window.showAbout = showAbout;
        window.submitAd = submitAd;
        window.getLocation = getLocation;
        window.selectLocation = selectLocation;
        window.handlePhotos = handlePhotos;
        window.removePhoto = removePhoto;
        window.approveAd = approveAd;
        window.showRejectModal = showRejectModal;
        window.closeRejectModal = closeRejectModal;
        window.updateRejectReason = updateRejectReason;
        window.confirmReject = confirmReject;
        window.rejectAd = rejectAd;
        window.viewPhoto = viewPhoto;
        window.showMyAdsSection = showMyAdsSection;
        window.loadActiveAds = loadActiveAds;
        window.loadArchivedAds = loadArchivedAds;
        window.openRejectedAd = openRejectedAd;
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        setTimeout(() => {
            console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:');
            console.log('üîç –ö–Ω–æ–ø–∫–∞ –ø–æ–∏—Å–∫–∞:', document.querySelector('.search-btn') ? '‚úÖ' : '‚ùå');
            console.log('üîç –§–∏–ª—å—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π:', document.getElementById('category-filter') ? '‚úÖ' : '‚ùå');
            console.log('üîç –ê–¥–º–∏–Ω—Å–∫–∏–µ –≤–∫–ª–∞–¥–∫–∏:', document.querySelector('.admin-tabs') ? '‚úÖ' : '‚ùå');
            console.log('üîç –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥:', document.getElementById('back-btn') ? '‚úÖ' : '‚ùå');
            console.log('üîç –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è:', document.querySelector('.fab-button') ? '‚úÖ' : '‚ùå');
        }, 200);
    </script>
</body>
</html>
