<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>Lavka26 - –û–±—ä—è–≤–ª–µ–Ω–∏—è</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <!-- –í–ï–†–•–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ (fixed) -->
        <header class="app-header">
            <div class="header-left">
                <div class="app-title">LAVKA26</div>
            </div>
            <div class="header-right">
                <button class="header-btn" onclick="switchTab('messages')">
                    <i class="fas fa-comment"></i>
                    <span class="badge" id="messages-badge" style="display: none;"></span>
                </button>
                <button class="header-btn" onclick="switchTab('favorites')">
                    <i class="fas fa-heart"></i>
                    <span class="badge" id="favorites-badge" style="display: none;"></span>
                </button>
                <button class="header-btn" onclick="switchTab('profile')">
                    <i class="fas fa-user"></i>
                </button>
            </div>
        </header>

        <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ (scroll) -->
        <main class="app-content">
            <!-- –ì–ª–∞–≤–Ω–∞—è: –õ–µ–Ω—Ç–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π -->
            <div class="tab-content active" id="feed-tab">
                <!-- –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ -->
                <div class="search-section">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –∏ —É—Å–ª—É–≥">
                        <button class="filter-btn">
                            <i class="fas fa-sliders-h"></i>
                        </button>
                    </div>
                </div>

                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                <div class="categories-section">
                    <div class="categories-grid">
                        <div class="category-item" data-category="electronics">
                            <i class="fas fa-mobile-alt"></i>
                            <span>–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</span>
                        </div>
                        <div class="category-item" data-category="transport">
                            <i class="fas fa-car"></i>
                            <span>–ê–≤—Ç–æ–º–æ–±–∏–ª–∏</span>
                        </div>
                        <div class="category-item" data-category="realestate">
                            <i class="fas fa-home"></i>
                            <span>–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</span>
                        </div>
                        <div class="category-item" data-category="clothing">
                            <i class="fas fa-tshirt"></i>
                            <span>–û–¥–µ–∂–¥–∞</span>
                        </div>
                        <div class="category-item" data-category="home">
                            <i class="fas fa-couch"></i>
                            <span>–î–ª—è –¥–æ–º–∞</span>
                        </div>
                        <div class="category-item" data-category="services">
                            <i class="fas fa-wrench"></i>
                            <span>–£—Å–ª—É–≥–∏</span>
                        </div>
                        <div class="category-item" data-category="kids">
                            <i class="fas fa-baby"></i>
                            <span>–î–µ—Ç—Å–∫–æ–µ</span>
                        </div>
                        <div class="category-item" data-category="sport">
                            <i class="fas fa-dumbbell"></i>
                            <span>–°–ø–æ—Ä—Ç</span>
                        </div>
                    </div>
                </div>

                <!-- –°–ø–∏—Å–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π -->
                <div class="ads-section">
                    <div class="section-header">
                        <h2>–í—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h2>
                        <button class="sort-btn">
                            <i class="fas fa-sort"></i>
                            –ü–æ –¥–∞—Ç–µ
                        </button>
                    </div>
                    <div class="ads-grid" id="ads-container">
                        <!-- –û–±—ä—è–≤–ª–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                        <div class="empty-state">
                            <i class="fas fa-search"></i>
                            <h3>–û–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                            <p>–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–µ!</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
            <div class="tab-content" id="categories-tab">
                <div class="categories-section">
                    <div class="section-header">
                        <h2>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
                    </div>
                    <div class="categories-grid">
                        <div class="category-item" onclick="openCategory('electronics')">
                            <i class="fas fa-mobile-alt"></i>
                            <span>–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</span>
                        </div>
                        <div class="category-item" onclick="openCategory('transport')">
                            <i class="fas fa-car"></i>
                            <span>–ê–≤—Ç–æ–º–æ–±–∏–ª–∏</span>
                        </div>
                        <div class="category-item" onclick="openCategory('realestate')">
                            <i class="fas fa-home"></i>
                            <span>–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</span>
                        </div>
                        <div class="category-item" onclick="openCategory('clothing')">
                            <i class="fas fa-tshirt"></i>
                            <span>–û–¥–µ–∂–¥–∞ –∏ –æ–±—É–≤—å</span>
                        </div>
                        <div class="category-item" onclick="openCategory('home')">
                            <i class="fas fa-couch"></i>
                            <span>–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–æ–º–∞</span>
                        </div>
                        <div class="category-item" onclick="openCategory('services')">
                            <i class="fas fa-wrench"></i>
                            <span>–£—Å–ª—É–≥–∏</span>
                        </div>
                        <div class="category-item" onclick="openCategory('kids')">
                            <i class="fas fa-baby"></i>
                            <span>–î–µ—Ç—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã</span>
                        </div>
                        <div class="category-item" onclick="openCategory('sport')">
                            <i class="fas fa-dumbbell"></i>
                            <span>–°–ø–æ—Ä—Ç –∏ –æ—Ç–¥—ã—Ö</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ò–∑–±—Ä–∞–Ω–Ω–æ–µ -->
            <div class="tab-content" id="favorites-tab">
                <div class="favorites-section">
                    <div class="section-header">
                        <h2>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h2>
                        <button class="btn btn-ghost" onclick="clearFavorites()">
                            <i class="fas fa-trash"></i>
                            –û—á–∏—Å—Ç–∏—Ç—å
                        </button>
                    </div>
                    <div class="favorites-list" id="favorites-list">
                        <div class="empty-state">
                            <i class="fas fa-heart"></i>
                            <h3>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö</h3>
                            <p>–î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è ‚ù§Ô∏è</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
            <div class="tab-content" id="my-ads-tab">
                <div class="my-ads-section">
                    <div class="section-header">
                        <h2>–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h2>
                        <button class="btn btn-primary" onclick="openCreateAd()">
                            <i class="fas fa-plus"></i>
                            –°–æ–∑–¥–∞—Ç—å
                        </button>
                    </div>
                    
                    <!-- –§–∏–ª—å—Ç—Ä—ã —Å—Ç–∞—Ç—É—Å–æ–≤ -->
                    <div class="status-filters">
                        <button class="status-filter active" onclick="filterMyAds('all')">–í—Å–µ</button>
                        <button class="status-filter" onclick="filterMyAds('pending')">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</button>
                        <button class="status-filter" onclick="filterMyAds('active')">–ê–∫—Ç–∏–≤–Ω—ã–µ</button>
                        <button class="status-filter" onclick="filterMyAds('rejected')">–û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ</button>
                    </div>
                    
                    <div class="my-ads-list" id="my-ads-list">
                        <div class="empty-state">
                            <i class="fas fa-ad"></i>
                            <h3>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π</h3>
                            <p>–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–µ –ø–µ—Ä–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</p>
                            <button class="btn btn-primary" onclick="openCreateAd()">
                                <i class="fas fa-plus"></i>
                                –°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
            <div class="tab-content" id="ad-detail-tab">
                <div class="ad-detail-section">
                    <div class="ad-detail-header">
                        <button class="btn btn-ghost" onclick="switchTab('feed')">
                            <i class="fas fa-arrow-left"></i>
                            –ù–∞–∑–∞–¥
                        </button>
                        <button class="btn btn-ghost" onclick="shareAd()">
                            <i class="fas fa-share"></i>
                        </button>
                    </div>
                    
                    <div class="ad-detail-content" id="ad-detail-content">
                        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>

            <!-- –ß–∞—Ç -->
            <div class="tab-content" id="chat-tab">
                <div class="chat-section">
                    <div class="chat-header">
                        <button class="btn btn-ghost" onclick="switchTab('ad-detail')">
                            <i class="fas fa-arrow-left"></i>
                            –ù–∞–∑–∞–¥
                        </button>
                        <div class="chat-user-info">
                            <h3 id="chat-user-name">–ü—Ä–æ–¥–∞–≤–µ—Ü</h3>
                            <p id="chat-ad-title">–¢–æ–≤–∞—Ä</p>
                        </div>
                    </div>
                    
                    <div class="chat-messages" id="chat-messages">
                        <div class="empty-state">
                            <i class="fas fa-comment"></i>
                            <h3>–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
                            <p>–ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º</p>
                        </div>
                    </div>
                    
                    <div class="chat-input-container">
                        <input type="text" id="chat-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                        <button class="btn btn-primary" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
            <div class="tab-content" id="profile-tab">
                <div class="profile-section">
                    <div class="profile-header">
                        <div class="profile-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="profile-info">
                            <h2 id="profile-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h2>
                            <p id="profile-username">@username</p>
                        </div>
                    </div>
                    <div class="profile-stats">
                        <div class="stat-item">
                            <span>0</span>
                            <span>–û–±—ä—è–≤–ª–µ–Ω–∏–π</span>
                        </div>
                        <div class="stat-item">
                            <span>0.0</span>
                            <span>–†–µ–π—Ç–∏–Ω–≥</span>
                        </div>
                    </div>
                    <div class="profile-menu">
                        <button class="menu-item" onclick="openCreateAd()">
                            <i class="fas fa-plus"></i>
                            <span>–°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</span>
                        </button>
                        <button class="menu-item" onclick="loadMyAds()">
                            <i class="fas fa-ad"></i>
                            <span>–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</span>
                        </button>
                        <button class="menu-item" onclick="openSettings()">
                            <i class="fas fa-cog"></i>
                            <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                        </button>
                        <button class="menu-item" id="moderator-panel-btn" style="display: none;" onclick="openModeratorPanel()">
                            <i class="fas fa-shield-alt"></i>
                            <span>üõ° –ü–∞–Ω–µ–ª—å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ -->
            <div class="tab-content" id="moderator-tab">
                <div class="moderator-section">
                    <div class="section-header">
                        <h2>ÔøΩ –ü–∞–Ω–µ–ª—å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞</h2>
                        <button class="btn btn-ghost" onclick="loadModeratorStats()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>

                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                    <div class="stats-grid" id="mod-stats">
                        <div class="stat-card">
                            <div class="stat-number" id="total-ads">0</div>
                            <div class="stat-label">–í—Å–µ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="pending-ads">0</div>
                            <div class="stat-label">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="active-ads">0</div>
                            <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="blocked-users">0</div>
                            <div class="stat-label">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ</div>
                        </div>
                    </div>

                <!-- –û–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ -->
                <div class="mod-section">
                    <h3>üìã –û–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h3>
                    <div class="mod-controls">
                        <button class="btn-secondary" onclick="refreshPendingAds()">
                            <i class="fas fa-sync"></i> –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                    <div class="pending-ads-list" id="pending-ads-list">
                        <div class="loading-placeholder">–ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π...</div>
                    </div>
                </div>

                <!-- –ñ–∞–ª–æ–±—ã -->
                <div class="mod-section">
                    <h3>üö® –ñ–∞–ª–æ–±—ã</h3>
                    <div class="mod-controls">
                        <button class="btn-secondary" onclick="refreshReports()">
                            <i class="fas fa-sync"></i> –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                    <div class="reports-list" id="reports-list">
                        <div class="loading-placeholder">–ó–∞–≥—Ä—É–∑–∫–∞ –∂–∞–ª–æ–±...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
        <div class="modal" id="create-ad-modal">
            <div class="modal-content create-ad-modal">
                <div class="modal-header">
                    <h3>üìù –°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</h3>
                    <button class="close-btn" onclick="closeCreateAdModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="create-ad-form">
                        <!-- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ -->
                        <div class="form-group">
                            <label>–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</label>
                            <div class="image-upload-area" onclick="document.getElementById('ad-images').click()">
                                <div class="upload-placeholder" id="upload-placeholder">
                                    <i class="fas fa-camera"></i>
                                    <p>–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</p>
                                    <small>–î–æ 5 —Ñ–æ—Ç–æ, –Ω–µ –±–æ–ª–µ–µ 10 –ú–ë –∫–∞–∂–¥–æ–µ</small>
                                </div>
                                <div class="image-preview" id="image-preview"></div>
                                <input type="file" id="ad-images" multiple accept="image/*" style="display: none;">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è *</label>
                            <input type="text" id="ad-title" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: iPhone 13 Pro 128 –ì–ë" required>
                        </div>
                        
                        <div class="form-group">
                            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                            <select id="ad-category" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                                <option value="electronics">üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</option>
                                <option value="transport">üöó –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</option>
                                <option value="realestate">üè† –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</option>
                                <option value="clothing">üëï –û–¥–µ–∂–¥–∞</option>
                                <option value="home">üè° –î–æ–º –∏ —Å–∞–¥</option>
                                <option value="jobs">üíº –†–∞–±–æ—Ç–∞</option>
                                <option value="services">üîß –£—Å–ª—É–≥–∏</option>
                                <option value="other">üì¶ –î—Ä—É–≥–æ–µ</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>–¶–µ–Ω–∞ (‚ÇΩ) *</label>
                            <input type="number" id="ad-price" placeholder="10000" required>
                        </div>
                        
                        <div class="form-group">
                            <label>–ì–æ—Ä–æ–¥</label>
                            <input type="text" id="ad-location" placeholder="–ú–æ—Å–∫–≤–∞">
                        </div>
                        
                        <div class="form-group">
                            <label>–û–ø–∏—Å–∞–Ω–∏–µ *</label>
                            <textarea id="ad-description" rows="4" placeholder="–û–ø–∏—à–∏—Ç–µ —Ç–æ–≤–∞—Ä –ø–æ–¥—Ä–æ–±–Ω–æ: —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–¥–∞–∂–∏..." required></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeCreateAdModal()">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn-primary" onclick="publishAd()">
                        <i class="fas fa-paper-plane"></i> –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
                    </button>
                </div>
            </div>
        </div> 
                                       placeholder="–ì–æ—Ä–æ–¥ –∏–ª–∏ —Ä–∞–π–æ–Ω">
                            </div>
                        </div>

                        <!-- –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                        <div class="form-group">
                            <label>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</label>
                            <div class="contact-options">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="show-phone" checked>
                                    <span class="checkmark"></span>
                                    –ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="allow-messages" checked>
                                    <span class="checkmark"></span>
                                    –†–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
        <div class="modal" id="ad-modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <button class="back-btn" onclick="closeModal()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h3 id="modal-title">–û–±—ä—è–≤–ª–µ–Ω–∏–µ</h3>
                    <button class="share-btn" onclick="shareAd()">
                        <i class="fas fa-share-alt"></i>
                    </button>
                </div>
                <div class="modal-body" id="modal-body">
                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
                </div>
                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="toggleFavorite()">
                        <i class="fas fa-heart"></i>
                        <span>–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
                    </button>
                    <button class="action-btn primary" onclick="contactSeller()">
                        <i class="fas fa-phone"></i>
                        <span>–°–≤—è–∑–∞—Ç—å—Å—è</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
        <div class="modal" id="filters-modal" style="display: none;">
            <div class="modal-content filters-modal">
                <div class="modal-header">
                    <button class="close-btn" onclick="closeFilters()">
                        <i class="fas fa-times"></i>
                    </button>
                    <h3>–§–∏–ª—å—Ç—Ä—ã</h3>
                    <button class="reset-btn" onclick="resetFilters()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>
                <div class="modal-body">
                    <div class="filter-section">
                        <h4>–¶–µ–Ω–∞</h4>
                        <div class="price-range">
                            <input type="number" id="price-min" placeholder="–û—Ç">
                            <span>-</span>
                            <input type="number" id="price-max" placeholder="–î–æ">
                        </div>
                    </div>
                    
                    <div class="filter-section">
                        <h4>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</h4>
                        <div class="location-input">
                            <i class="fas fa-map-marker-alt"></i>
                            <input type="text" id="location" placeholder="–ì–æ—Ä–æ–¥ –∏–ª–∏ —Ä–∞–π–æ–Ω">
                        </div>
                        <div class="distance-slider">
                            <label>–†–∞–¥–∏—É—Å: <span id="distance-value">10</span> –∫–º</label>
                            <input type="range" id="distance" min="1" max="100" value="10">
                        </div>
                    </div>
                    
                    <div class="filter-section">
                        <h4>–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</h4>
                        <div class="date-options">
                            <label><input type="radio" name="date" value="today" checked> –°–µ–≥–æ–¥–Ω—è</label>
                            <label><input type="radio" name="date" value="week"> –ó–∞ –Ω–µ–¥–µ–ª—é</label>
                            <label><input type="radio" name="date" value="month"> –ó–∞ –º–µ—Å—è—Ü</label>
                            <label><input type="radio" name="date" value="all"> –í—Å–µ –≤—Ä–µ–º—è</label>
                        </div>
                    </div>
                    
                    <div class="filter-section">
                        <h4>–¢–æ–ª—å–∫–æ —Å —Ñ–æ—Ç–æ</h4>
                        <label class="switch">
                            <input type="checkbox" id="with-photos">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeFilters()">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn-primary" onclick="applyFilters()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
        <div class="notifications" id="notifications"></div>

        <!-- –ù–ò–ñ–ù–Ø–Ø –ù–ê–í–ò–ì–ê–¶–ò–Ø (fixed) -->
        <nav class="tabbar">
            <button class="tabbar-item active" data-tab="feed" onclick="switchTab('feed')">
                <i class="fas fa-home"></i>
                <span>–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            <button class="tabbar-item" data-tab="categories" onclick="switchTab('categories')">
                <i class="fas fa-th-large"></i>
                <span>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</span>
            </button>
            <button class="tabbar-item" data-tab="favorites" onclick="switchTab('favorites')">
                <i class="fas fa-heart"></i>
                <span>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
            </button>
            <button class="tabbar-item" data-tab="profile" onclick="switchTab('profile')">
                <i class="fas fa-user"></i>
                <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
            </button>
        </nav>
    </div>

    <script src="app.js"></script>
    <script>
        // –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
        console.log('üöÄ Lavka26 –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...');
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
        const loading = document.getElementById('loading');
        const content = document.getElementById('content');
        if (loading) loading.style.display = 'none';
        if (content) content.style.display = 'block';
        
        // –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        window.openCreateAd = function() {
            const modal = document.getElementById('create-ad-modal');
            if (modal) {
                modal.style.display = 'flex';
                showNotification('–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è', 'info');
            }
        };
        
        window.closeCreateAdModal = function() {
            const modal = document.getElementById('create-ad-modal');
            if (modal) {
                modal.style.display = 'none';
                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('create-ad-form').reset();
                document.getElementById('image-preview').innerHTML = '';
                document.getElementById('upload-placeholder').style.display = 'block';
            }
        };
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        window.uploadedImages = [];
        
        window.publishAd = async function() {
            const title = document.getElementById('ad-title').value;
            const category = document.getElementById('ad-category').value;
            const price = document.getElementById('ad-price').value;
            const description = document.getElementById('ad-description').value;
            const location = document.getElementById('ad-location').value;
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è
            if (!title || !category || !price || !description) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            if (title.length < 3) {
                showNotification('–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞', 'error');
                return;
            }
            
            if (description.length < 10) {
                showNotification('–û–ø–∏—Å–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
                return;
            }
            
            if (price <= 0) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ü–µ–Ω—É', 'error');
                return;
            }
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram WebApp
                const tg = window.Telegram?.WebApp;
                const user = tg?.initDataUnsafe?.user;
                
                if (!user) {
                    showNotification('–û—à–∏–±–∫–∞: –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã', 'error');
                    return;
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                const submitBtn = document.querySelector('.modal-footer .btn-primary');
                const originalText = submitBtn.innerHTML;
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –ü—É–±–ª–∏–∫–∞—Ü–∏—è...';
                
                // –°–æ–∑–¥–∞–µ–º –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
                const adData = {
                    title: title.trim(),
                    category: category,
                    price: parseInt(price),
                    description: description.trim(),
                    location: location.trim() || '–ù–µ —É–∫–∞–∑–∞–Ω–æ',
                    images: window.uploadedImages,
                    user_id: user.id,
                    user_name: `${user.first_name} ${user.last_name || ''}`.trim()
                };
                
                const response = await fetch('/api/ads', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(adData)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ!', 'success');
                    closeCreateAdModal();
                    
                    // –û—á–∏—â–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    window.uploadedImages = [];
                    
                    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞ "–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è"
                    setTimeout(() => {
                        switchTab('my-ads');
                    }, 1000);
                } else {
                    const error = await response.json();
                    showNotification(error.error || '–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è', 'error');
                }
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
                
            } catch (error) {
                console.error('Error creating ad:', error);
                showNotification('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É', 'error');
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
                const submitBtn = document.querySelector('.modal-footer .btn-primary');
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å';
            }
        };
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        document.addEventListener('DOMContentLoaded', function() {
            const imageInput = document.getElementById('ad-images');
            if (imageInput) {
                imageInput.addEventListener('change', function(e) {
                    const files = e.target.files;
                    const preview = document.getElementById('image-preview');
                    const placeholder = document.getElementById('upload-placeholder');
                    
                    if (files.length > 0) {
                        placeholder.style.display = 'none';
                    }
                    
                    Array.from(files).forEach(file => {
                        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞
                        if (!file.type.startsWith('image/')) {
                            showNotification(`${file.name} –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º`, 'error');
                            return;
                        }
                        
                        if (file.size > 10 * 1024 * 1024) {
                            showNotification(`${file.name} —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å–∏–º—É–º 10 –ú–ë)`, 'error');
                            return;
                        }
                        
                        if (window.uploadedImages.length >= 5) {
                            showNotification('–ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–µ –±–æ–ª–µ–µ 5 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π', 'error');
                            return;
                        }
                        
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const imgDiv = document.createElement('div');
                            imgDiv.className = 'image-preview-item';
                            imgDiv.innerHTML = `
                                <img src="${e.target.result}" alt="Preview">
                                <button type="button" onclick="removeImage(this, '${e.target.result}')" class="remove-image">
                                    <i class="fas fa-times"></i>
                                </button>
                            `;
                            preview.appendChild(imgDiv);
                            
                            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –º–∞—Å—Å–∏–≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
                            window.uploadedImages.push(e.target.result);
                        };
                        reader.readAsDataURL(file);
                    });
                });
            }
        });
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        window.removeImage = function(button, imageSrc) {
            const imgDiv = button.parentElement;
            imgDiv.remove();
            
            // –£–¥–∞–ª—è–µ–º –∏–∑ –º–∞—Å—Å–∏–≤–∞
            const index = window.uploadedImages.indexOf(imageSrc);
            if (index > -1) {
                window.uploadedImages.splice(index, 1);
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º placeholder –µ—Å–ª–∏ –Ω–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            if (window.uploadedImages.length === 0) {
                document.getElementById('upload-placeholder').style.display = 'block';
            }
        };
        
        // –§—É–Ω–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        async function loadAds() {
            const adsContainer = document.getElementById('ads-container');
            if (!adsContainer) return;
            
            try {
                const response = await fetch('/api/ads?status=active&limit=20');
                const ads = await response.json();
                
                if (ads.ads.length === 0) {
                    adsContainer.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-search"></i>
                            <h3>–û–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                            <p>–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–µ!</p>
                        </div>
                    `;
                    return;
                }
                
                const adsHTML = ads.ads.map(ad => createAdCard(ad)).join('');
                adsContainer.innerHTML = adsHTML;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π:', error);
                adsContainer.innerHTML = `
                    <div class="error-state">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h3>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</p>
                    </div>
                `;
            }
        }

        function createAdCard(ad) {
            const user = getCurrentUser();
            const isOwner = user && ad.user_id === user.id;
            const isFavorite = checkIfFavorite(ad.id);
            
            return `
                <div class="ad-card" onclick="openAdDetail('${ad.id}')">
                    <div class="ad-image">
                        ${ad.images && ad.images.length > 0 
                            ? `<img src="${ad.images[0]}" alt="${escapeHtml(ad.title)}" loading="lazy">`
                            : `<div class="no-image"><i class="fas fa-image"></i></div>`
                        }
                        ${isOwner ? '<div class="ad-owner-badge">–ú–æ—ë</div>' : ''}
                        <button class="ad-favorite ${isFavorite ? 'active' : ''}" 
                                onclick="event.stopPropagation(); toggleFavorite('${ad.id}')">
                            <i class="fas fa-heart"></i>
                        </button>
                    </div>
                    <div class="ad-content">
                        <div class="ad-title">${escapeHtml(ad.title)}</div>
                        <div class="ad-price">${formatPrice(ad.price)} ‚ÇΩ</div>
                        <div class="ad-meta">
                            <span class="ad-location">
                                <i class="fas fa-map-marker-alt"></i>
                                ${escapeHtml(ad.city || '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}
                            </span>
                            <span class="ad-date">${formatDate(ad.created_at)}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        window.openCategory = function(category) {
            loadCategoryAds(category);
        };

        async function loadCategoryAds(category) {
            const adsContainer = document.getElementById('ads-container');
            if (!adsContainer) return;
            
            try {
                const response = await fetch(`/api/ads?category=${category}&status=active&limit=20`);
                const ads = await response.json();
                
                if (ads.ads.length === 0) {
                    adsContainer.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-folder-open"></i>
                            <h3>–ù–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
                            <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é</p>
                        </div>
                    `;
                    return;
                }
                
                const adsHTML = ads.ads.map(ad => createAdCard(ad)).join('');
                adsContainer.innerHTML = adsHTML;
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é
                switchTab('feed');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
        window.loadFavorites = async function() {
            const container = document.getElementById('favorites-list');
            if (!container) return;
            
            const favorites = getFavorites();
            
            if (favorites.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-heart"></i>
                        <h3>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö</h3>
                        <p>–î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è ‚ù§Ô∏è</p>
                    </div>
                `;
                return;
            }
            
            try {
                const adsHTML = favorites.map(ad => createAdCard(ad)).join('');
                container.innerHTML = adsHTML;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ:', error);
            }
        };

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–±—Ä–∞–Ω–Ω—ã–º
        function getFavorites() {
            return JSON.parse(localStorage.getItem('favorites') || '[]');
        }

        function saveFavorites(favorites) {
            localStorage.setItem('favorites', JSON.stringify(favorites));
            updateFavoritesBadge();
        }

        function checkIfFavorite(adId) {
            const favorites = getFavorites();
            return favorites.some(ad => ad.id === adId);
        }

        window.toggleFavorite = async function(adId) {
            const favorites = getFavorites();
            const index = favorites.findIndex(ad => ad.id === adId);
            
            if (index === -1) {
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
                try {
                    const response = await fetch(`/api/ads/${adId}`);
                    const ad = await response.json();
                    favorites.push(ad);
                    showNotification('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ', 'success');
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ:', error);
                }
            } else {
                // –£–¥–∞–ª—è–µ–º –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
                favorites.splice(index, 1);
                showNotification('–£–¥–∞–ª–µ–Ω–æ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ', 'info');
            }
            
            saveFavorites(favorites);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            if (document.querySelector('.tab-content.active').id === 'favorites-tab') {
                loadFavorites();
            }
        };

        window.clearFavorites = function() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è?')) {
                localStorage.removeItem('favorites');
                loadFavorites();
                showNotification('–ò–∑–±—Ä–∞–Ω–Ω–æ–µ –æ—á–∏—â–µ–Ω–æ', 'info');
            }
        };

        function updateFavoritesBadge() {
            const favorites = getFavorites();
            const badge = document.getElementById('favorites-badge');
            if (badge) {
                if (favorites.length > 0) {
                    badge.textContent = favorites.length > 9 ? '9+' : favorites.length;
                    badge.style.display = 'flex';
                } else {
                    badge.style.display = 'none';
                }
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
        window.loadMyAds = async function() {
            const container = document.getElementById('my-ads-list');
            if (!container) return;
            
            const user = getCurrentUser();
            if (!user.id) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-user"></i>
                        <h3>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è</h3>
                        <p>–í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ Telegram</p>
                    </div>
                `;
                return;
            }
            
            try {
                const response = await fetch(`/api/ads?user_id=${user.id}&limit=50`);
                const ads = await response.json();
                
                if (ads.ads.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-ad"></i>
                            <h3>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π</h3>
                            <p>–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–µ –ø–µ—Ä–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</p>
                            <button class="btn btn-primary" onclick="openCreateAd()">
                                <i class="fas fa-plus"></i>
                                –°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
                            </button>
                        </div>
                    `;
                    return;
                }
                
                const adsHTML = ads.ads.map(ad => createMyAdCard(ad)).join('');
                container.innerHTML = adsHTML;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π:', error);
            }
        };

        function createMyAdCard(ad) {
            const statusClass = `status-${ad.status}`;
            const statusText = {
                'pending': '–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏',
                'active': '–ê–∫—Ç–∏–≤–Ω–æ',
                'rejected': '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ'
            }[ad.status] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
            
            return `
                <div class="my-ad-card">
                    <div class="my-ad-header">
                        <h4>${escapeHtml(ad.title)}</h4>
                        <span class="status-badge ${statusClass}">${statusText}</span>
                    </div>
                    <div class="my-ad-content">
                        <div class="my-ad-price">${formatPrice(ad.price)} ‚ÇΩ</div>
                        <div class="my-ad-meta">
                            <span><i class="fas fa-map-marker-alt"></i> ${escapeHtml(ad.city || '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}</span>
                            <span><i class="fas fa-clock"></i> ${formatDate(ad.created_at)}</span>
                        </div>
                        ${ad.description ? `<div class="my-ad-description">${escapeHtml(ad.description)}</div>` : ''}
                    </div>
                    <div class="my-ad-actions">
                        <button class="btn btn-secondary" onclick="editAd('${ad.id}')">
                            <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button class="btn btn-danger" onclick="deleteMyAd('${ad.id}')">
                            <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>
            `;
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º–æ–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
        window.filterMyAds = async function(status) {
            const user = getCurrentUser();
            if (!user.id) return;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä
            document.querySelectorAll('.status-filter').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            try {
                const response = await fetch(`/api/ads?user_id=${user.id}&status=${status}&limit=50`);
                const ads = await response.json();
                
                const container = document.getElementById('my-ads-list');
                
                if (ads.ads.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-filter"></i>
                            <h3>–ù–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π</h3>
                            <p>–í –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π</p>
                        </div>
                    `;
                    return;
                }
                
                const adsHTML = ads.ads.map(ad => createMyAdCard(ad)).join('');
                container.innerHTML = adsHTML;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:', error);
            }
        };

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
        window.editAd = function(adId) {
            showNotification('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
        };

        // –£–¥–∞–ª–µ–Ω–∏–µ –º–æ–µ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
        window.deleteMyAd = async function(adId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ?')) return;
            
            try {
                const response = await fetch(`/api/ads/${adId}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        user: getCurrentUser()
                    })
                });
                
                if (response.ok) {
                    showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ', 'success');
                    await loadMyAds();
                } else {
                    const error = await response.json();
                    showNotification(error.error || '–û—à–∏–±–∫–∞', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
                showNotification('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è', 'error');
            }
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        window.loadCategories = async function() {
            // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É–∂–µ –≤ HTML, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –∑–∞–≥—Ä—É–∑–∫—É –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            console.log('–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
        window.loadMessages = async function() {
            const container = document.getElementById('messages-list');
            if (!container) return;
            
            container.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-comment"></i>
                    <h3>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
                    <p>–ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ–¥–∞–≤—Ü–∞–º–∏</p>
                </div>
            `;
        };

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Ç–∞–ª–µ–π –æ–±—ä—è–≤–ª–µ–Ω–∏—è
        window.openAdDetail = async function(adId) {
            try {
                const response = await fetch(`/api/ads/${adId}`);
                const ad = await response.json();
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –¥–ª—è —á–∞—Ç–∞
                window.currentAd = ad;
                
                const content = document.getElementById('ad-detail-content');
                content.innerHTML = `
                    <div class="ad-gallery">
                        ${ad.images && ad.images.length > 0 
                            ? ad.images.map(img => `
                                <div class="gallery-item">
                                    <img src="${img}" alt="${escapeHtml(ad.title)}">
                                </div>
                            `).join('')
                            : `<div class="no-image-large"><i class="fas fa-image"></i></div>`
                        }
                    </div>
                    
                    <div class="ad-details">
                        <div class="ad-price-large">${formatPrice(ad.price)} ‚ÇΩ</div>
                        
                        <div class="ad-meta-info">
                            <span><i class="fas fa-map-marker-alt"></i> ${escapeHtml(ad.city || '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}</span>
                            <span><i class="fas fa-clock"></i> ${formatDate(ad.created_at)}</span>
                        </div>
                        
                        <div class="ad-description-full">
                            <h4>${escapeHtml(ad.title)}</h4>
                            <p>${escapeHtml(ad.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç')}</p>
                        </div>
                        
                        <div class="ad-seller-info">
                            <h4>–ü—Ä–æ–¥–∞–≤–µ—Ü</h4>
                            <div class="seller-card">
                                <div class="seller-avatar">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="seller-details">
                                    <div class="seller-name">${escapeHtml(ad.user_name || '–ü—Ä–æ–¥–∞–≤–µ—Ü')}</div>
                                    <div class="seller-rating">‚≠ê 5.0</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-actions">
                        <button class="action-btn secondary" onclick="addToFavorites('${ad.id}')">
                            <i class="fas fa-heart"></i>
                            –í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
                        </button>
                        <button class="action-btn primary" onclick="openChat('${ad.id}')">
                            <i class="fas fa-comment"></i>
                            –ù–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ–¥–∞–≤—Ü—É
                        </button>
                    </div>
                `;
                
                switchTab('ad-detail');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è', 'error');
            }
        };

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ –∏–∑ –¥–µ—Ç–∞–ª–µ–π
        window.addToFavorites = function(adId) {
            toggleFavorite(adId);
        };

        // –û—Ç–∫—Ä—ã—Ç–∏–µ —á–∞—Ç–∞
        window.openChat = async function(adId) {
            if (!window.currentAd || window.currentAd.id !== adId) {
                await openAdDetail(adId);
            }
            
            // –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –ø–æ–ª—É—á–∞–µ–º —á–∞—Ç
            try {
                const response = await fetch(`/api/chats/${adId}`);
                const chat = await response.json();
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —á–∞—Ç–µ
                document.getElementById('chat-user-name').textContent = window.currentAd.user_name || '–ü—Ä–æ–¥–∞–≤–µ—Ü';
                document.getElementById('chat-ad-title').textContent = window.currentAd.title;
                
                // –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ —á–∞—Ç—É
                await fetch(`/api/chats/${chat.id}/join`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        user: getCurrentUser()
                    })
                });
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
                await loadChatMessages(chat.id);
                
                switchTab('chat');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —á–∞—Ç–∞:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —á–∞—Ç–∞', 'error');
            }
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞
        async function loadChatMessages(chatId) {
            const container = document.getElementById('chat-messages');
            
            try {
                const response = await fetch(`/api/chats/${chatId}`);
                const chat = await response.json();
                
                if (!chat.messages || chat.messages.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-comment"></i>
                            <h3>–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
                            <p>–ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º</p>
                        </div>
                    `;
                    return;
                }
                
                const messagesHTML = chat.messages.map(msg => createMessageHTML(msg)).join('');
                container.innerHTML = messagesHTML;
                container.scrollTop = container.scrollHeight;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:', error);
            }
        }

        function createMessageHTML(message) {
            const isOwn = message.user_id === getCurrentUser().id;
            const time = formatDate(message.timestamp);
            
            return `
                <div class="message ${isOwn ? 'own' : 'other'}">
                    <div class="message-content">
                        <div class="message-text">${escapeHtml(message.text)}</div>
                        <div class="message-time">${time}</div>
                    </div>
                </div>
            `;
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
        window.sendMessage = async function() {
            const input = document.getElementById('chat-input');
            const text = input.value.trim();
            
            if (!text) return;
            
            if (!window.currentAd) {
                showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ', 'error');
                return;
            }
            
            try {
                // –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–µ–º/–ø–æ–ª—É—á–∞–µ–º —á–∞—Ç
                const chatResponse = await fetch(`/api/chats/${window.currentAd.id}`);
                const chat = await chatResponse.json();
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                const messageData = {
                    user_id: getCurrentUser().id,
                    text: text,
                    chat_id: chat.id
                };
                
                const response = await fetch(`/api/chats/${chat.id}/join`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        user: getCurrentUser()
                    })
                });
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
                input.value = '';
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
                await loadChatMessages(chat.id);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è', 'error');
            }
        };

        // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –æ–±—ä—è–≤–ª–µ–Ω–∏–µ–º
        window.shareAd = function() {
            if (!window.currentAd) return;
            
            if (navigator.share) {
                navigator.share({
                    title: window.currentAd.title,
                    text: `${window.currentAd.title} - ${formatPrice(window.currentAd.price)} ‚ÇΩ`,
                    url: window.location.href
                });
            } else {
                // –ö–æ–ø–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
                navigator.clipboard.writeText(window.location.href);
                showNotification('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞', 'success');
            }
        };

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
        window.openSettings = function() {
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
        };

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫
        window.switchTab = function(tabName) {
            console.log('switchTab –≤—ã–∑–≤–∞–Ω–∞ —Å:', tabName);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            const tabElement = document.getElementById(`${tabName}-tab`);
            if (tabElement) {
                tabElement.classList.add('active');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –≤–∫–ª–∞–¥–∫–∏
                if (tabName === 'favorites') {
                    loadFavorites();
                } else if (tabName === 'my-ads') {
                    loadMyAds();
                } else if (tabName === 'profile') {
                    loadProfile();
                } else if (tabName === 'moderator') {
                    loadModeratorPanel();
                } else if (tabName === 'categories') {
                    loadCategories();
                } else if (tabName === 'messages') {
                    loadMessages();
                } else if (tabName === 'feed') {
                    loadAds(); // –ó–∞–≥—Ä—É–∂–∞–µ–º –ª–µ–Ω—Ç—É –æ–±—ä—è–≤–ª–µ–Ω–∏–π
                }
            }
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.tabbar-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            const activeBtn = document.querySelector(`.tabbar-item[data-tab="${tabName}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ä–æ–ª–∏
        window.loadProfile = async function() {
            try {
                const tg = window.Telegram?.WebApp;
                const user = tg?.initDataUnsafe?.user;
                
                if (!user) {
                    console.error('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω');
                    return;
                }

                const response = await fetch(`/api/users/${user.id}`);
                const userData = await response.json();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –ø—Ä–æ—Ñ–∏–ª–µ
                document.getElementById('profile-name').textContent = 
                    `${userData.first_name} ${userData.last_name || ''}`.trim();
                document.getElementById('profile-username').textContent = 
                    userData.username ? `@${userData.username}` : '';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                const moderatorBtn = document.getElementById('moderator-panel-btn');
                if (userData.role === 'MODERATOR') {
                    moderatorBtn.style.display = 'flex';
                } else {
                    moderatorBtn.style.display = 'none';
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                if (userData.blocked) {
                    showNotification('–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –º–æ–¥–µ—Ä–∞—Ü–∏–µ–π', 'error');
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è:', error);
            }
        };

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–∞–Ω–µ–ª–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
        window.openModeratorPanel = function() {
            switchTab('moderator');
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞–Ω–µ–ª–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
        window.loadModeratorPanel = async function() {
            await loadModeratorStats();
            await loadPendingAds();
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
        window.loadModeratorStats = async function() {
            try {
                const response = await fetch('/api/moderation/stats');
                const stats = await response.json();
                
                document.getElementById('total-ads').textContent = stats.total_ads;
                document.getElementById('pending-ads').textContent = stats.pending_ads;
                document.getElementById('active-ads').textContent = stats.active_ads;
                document.getElementById('blocked-users').textContent = stats.blocked_users;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏', 'error');
            }
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
        window.loadPendingAds = async function() {
            try {
                const response = await fetch('/api/moderation/pending');
                const ads = await response.json();
                
                const container = document.getElementById('pending-ads-list');
                
                if (ads.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-clock"></i>
                            <h3>–ù–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h3>
                            <p>–í—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã</p>
                        </div>
                    `;
                    return;
                }
                
                const adsHTML = ads.map(ad => `
                    <div class="pending-ad-card">
                        <div class="pending-ad-header">
                            <div class="pending-ad-title">${escapeHtml(ad.title)}</div>
                            <div class="pending-ad-price">${formatPrice(ad.price)} ‚ÇΩ</div>
                        </div>
                        <div class="pending-ad-meta">
                            <span><i class="fas fa-user"></i> ${escapeHtml(ad.user_name || 'Unknown')}</span>
                            <span><i class="fas fa-clock"></i> ${formatDate(ad.created_at)}</span>
                        </div>
                        <div class="pending-ad-description">${escapeHtml(ad.description)}</div>
                        <div class="pending-ad-actions">
                            <button class="btn btn-success" onclick="approveAd('${ad.id}')">
                                <i class="fas fa-check"></i> –û–¥–æ–±—Ä–∏—Ç—å
                            </button>
                            <button class="btn btn-danger" onclick="rejectAd('${ad.id}')">
                                <i class="fas fa-times"></i> –û—Ç–∫–ª–æ–Ω–∏—Ç—å
                            </button>
                            <button class="btn btn-secondary" onclick="deleteAd('${ad.id}')">
                                <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </div>
                    </div>
                `).join('');
                
                container.innerHTML = adsHTML;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π', 'error');
            }
        };

        // –û–¥–æ–±—Ä–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
        window.approveAd = async function(adId) {
            try {
                const response = await fetch(`/api/moderation/approve/${adId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        user: getCurrentUser()
                    })
                });
                
                if (response.ok) {
                    showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ–¥–æ–±—Ä–µ–Ω–æ', 'success');
                    await loadPendingAds();
                    await loadModeratorStats();
                } else {
                    const error = await response.json();
                    showNotification(error.error || '–û—à–∏–±–∫–∞', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∏—è:', error);
                showNotification('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è', 'error');
            }
        };

        // –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
        window.rejectAd = async function(adId) {
            const reason = prompt('–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è:');
            if (!reason) return;
            
            try {
                const response = await fetch(`/api/moderation/reject/${adId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        user: getCurrentUser(),
                        reason: reason
                    })
                });
                
                if (response.ok) {
                    showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ', 'success');
                    await loadPendingAds();
                    await loadModeratorStats();
                } else {
                    const error = await response.json();
                    showNotification(error.error || '–û—à–∏–±–∫–∞', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è:', error);
                showNotification('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è', 'error');
            }
        };

        // –£–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
        window.deleteAd = async function(adId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ?')) return;
            
            try {
                const response = await fetch(`/api/moderation/delete/${adId}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        user: getCurrentUser()
                    })
                });
                
                if (response.ok) {
                    showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ', 'success');
                    await loadPendingAds();
                    await loadModeratorStats();
                } else {
                    const error = await response.json();
                    showNotification(error.error || '–û—à–∏–±–∫–∞', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
                showNotification('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è', 'error');
            }
        };

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getCurrentUser() {
            const tg = window.Telegram?.WebApp;
            return tg?.initDataUnsafe?.user || {};
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω—ã
        function formatPrice(price) {
            return new Intl.NumberFormat('ru-RU').format(price);
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã
        function formatDate(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) return '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
            if (diff < 3600000) return `${Math.floor(diff / 60000)} –º–∏–Ω –Ω–∞–∑–∞–¥`;
            if (diff < 86400000) return `${Math.floor(diff / 3600000)} —á –Ω–∞–∑–∞–¥`;
            if (diff < 604800000) return `${Math.floor(diff / 86400000)} –¥ –Ω–∞–∑–∞–¥`;
            
            return date.toLocaleDateString('ru-RU');
        }

        // –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        async function loadAds() {
            const adsContainer = document.getElementById('ads-container');
            if (!adsContainer) return;
            
            try {
                const response = await fetch('/api/ads?status=active&limit=20');
                const ads = await response.json();
                
                if (ads.length === 0) {
                    adsContainer.innerHTML = `
                        <div class="empty-state" style="text-align: center; padding: 40px;">
                            <i class="fas fa-search" style="font-size: 48px; color: var(--text-muted); margin-bottom: 16px;"></i>
                            <h3 style="color: var(--text-secondary); margin-bottom: 8px;">–û–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                            <p style="color: var(--text-muted);">–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–µ!</p>
                        </div>
                    `;
                    return;
                }
                
                const adsHTML = ads.map(ad => `
                    <div class="ad-card" onclick="openAd(${ad.id})">
                        <div class="ad-image">
                            ${ad.images && ad.images.length > 0 
                                ? `<img src="${ad.images[0]}" alt="${ad.title}">` 
                                : `<div class="no-image"><i class="fas fa-image"></i></div>`
                            }
                        </div>
                        <div class="ad-content">
                            <div class="ad-title">${escapeHtml(ad.title)}</div>
                            <div class="ad-price">${formatPrice(ad.price)} ‚ÇΩ</div>
                            <div class="ad-location">
                                <i class="fas fa-map-marker-alt"></i>
                                ${ad.location || '–ú–æ—Å–∫–≤–∞'}
                            </div>
                            <div class="ad-date">${formatDate(ad.created_at)}</div>
                        </div>
                    </div>
                `).join('');
                
                adsContainer.innerHTML = adsHTML;
            } catch (error) {
                console.error('Error loading ads:', error);
                adsContainer.innerHTML = '<div class="error-message">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</div>';
            }
        }
        
        function loadFavorites() {
            const favoritesList = document.getElementById('favorites-list');
            if (favoritesList) {
                favoritesList.innerHTML = `
                    <div class="empty-state" style="text-align: center; padding: 40px;">
                        <i class="fas fa-heart" style="font-size: 48px; color: var(--text-muted); margin-bottom: 16px;"></i>
                        <h3 style="color: var(--text-secondary); margin-bottom: 8px;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π</h3>
                        <p style="color: var(--text-muted);">–î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</p>
                    </div>
                `;
            }
        }
        
        async function loadMyAds() {
            const myAdsList = document.getElementById('my-ads-list');
            if (!myAdsList) return;
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const tg = window.Telegram?.WebApp;
                const user = tg?.initDataUnsafe?.user;
                
                if (!user) {
                    myAdsList.innerHTML = '<div class="error-message">–û—à–∏–±–∫–∞: –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                    return;
                }
                
                const response = await fetch(`/api/ads/user/${user.id}`);
                const myAds = await response.json();
                
                if (myAds.length === 0) {
                    myAdsList.innerHTML = `
                        <div class="empty-state" style="text-align: center; padding: 40px;">
                            <i class="fas fa-ad" style="font-size: 48px; color: var(--text-muted); margin-bottom: 16px;"></i>
                            <h3 style="color: var(--text-secondary); margin-bottom: 8px;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π</h3>
                            <p style="color: var(--text-muted);">–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–µ –ø–µ—Ä–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</p>
                            <button class="btn-primary" onclick="openCreateAd()" style="margin-top: 16px;">
                                <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
                            </button>
                        </div>
                    `;
                    return;
                }
                
                const adsHTML = myAds.map(ad => `
                    <div class="my-ad-card">
                        <div class="my-ad-image">
                            ${ad.images && ad.images.length > 0 
                                ? `<img src="${ad.images[0]}" alt="${ad.title}">` 
                                : `<div class="no-image"><i class="fas fa-image"></i></div>`
                            }
                        </div>
                        <div class="my-ad-content">
                            <div class="my-ad-header">
                                <h4>${escapeHtml(ad.title)}</h4>
                                <span class="status-badge status-${ad.status}">${getStatusText(ad.status)}</span>
                            </div>
                            <div class="my-ad-price">${formatPrice(ad.price)} ‚ÇΩ</div>
                            <div class="my-ad-meta">
                                <span class="ad-views">
                                    <i class="fas fa-eye"></i>
                                    ${ad.views || 0} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
                                </span>
                                <span class="ad-date">${formatDate(ad.created_at)}</span>
                            </div>
                            <div class="my-ad-actions">
                                ${ad.status === 'pending' ? '<span class="pending-text">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</span>' : ''}
                                ${ad.status === 'rejected' ? '<span class="rejected-text">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</span>' : ''}
                            </div>
                        </div>
                    </div>
                `).join('');
                
                myAdsList.innerHTML = adsHTML;
            } catch (error) {
                console.error('Error loading my ads:', error);
                myAdsList.innerHTML = '<div class="error-message">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</div>';
            }
        }
        
        async function loadModerator() {
            const moderatorContent = document.querySelector('.moderator-content');
            if (!moderatorContent) return;
            
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                const statsResponse = await fetch('/api/moderator/stats');
                const stats = await statsResponse.json();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
                const pendingResponse = await fetch('/api/ads?status=pending');
                const pendingAds = await pendingResponse.json();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                document.getElementById('total-ads').textContent = stats.total_ads || 0;
                document.getElementById('pending-ads').textContent = stats.pending_ads || 0;
                document.getElementById('active-ads').textContent = stats.active_ads || 0;
                document.getElementById('total-reports').textContent = stats.total_reports || 0;
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
                const pendingAdsList = document.getElementById('pending-ads-list');
                if (!pendingAds || pendingAds.length === 0) {
                    pendingAdsList.innerHTML = `
                        <div class="empty-state" style="text-align: center; padding: 40px;">
                            <i class="fas fa-check-circle" style="font-size: 48px; color: var(--text-muted); margin-bottom: 16px;"></i>
                            <h3 style="color: var(--text-secondary); margin-bottom: 8px;">–ù–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h3>
                            <p style="color: var(--text-muted);">–í—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã</p>
                        </div>
                    `;
                } else {
                    const adsHTML = pendingAds.map(ad => `
                        <div class="pending-ad-card">
                            <div class="pending-ad-header">
                                <h4>${escapeHtml(ad.title)}</h4>
                                <span class="price">${formatPrice(ad.price)} ‚ÇΩ</span>
                            </div>
                            <p>${escapeHtml(ad.description)}</p>
                            <div class="pending-ad-actions">
                                <button class="btn-success" onclick="approveAd(${ad.id})">
                                    <i class="fas fa-check"></i> –û–¥–æ–±—Ä–∏—Ç—å
                                </button>
                                <button class="btn-danger" onclick="rejectAd(${ad.id})">
                                    <i class="fas fa-times"></i> –û—Ç–∫–ª–æ–Ω–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    `).join('');
                    pendingAdsList.innerHTML = adsHTML;
                }
                
                showNotification('–ü–∞–Ω–µ–ª—å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞', 'success');
            } catch (error) {
                console.error('Error loading moderator panel:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞–Ω–µ–ª–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞', 'error');
            }
        }
        
        function loadMessages() {
            const messagesList = document.getElementById('messages-list');
            if (messagesList) {
                messagesList.innerHTML = `
                    <div class="empty-state" style="text-align: center; padding: 40px;">
                        <i class="fas fa-comment" style="font-size: 48px; color: var(--text-muted); margin-bottom: 16px;"></i>
                        <h3 style="color: var(--text-secondary); margin-bottom: 8px;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
                        <p style="color: var(--text-muted);">–ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ–¥–∞–≤—Ü–∞–º–∏</p>
                    </div>
                `;
            }
        }
        
        function loadProfile() {
            showNotification('–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'info');
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
        window.approveAd = async function(adId) {
            try {
                const response = await fetch(`/api/moderator/approve-ad/${adId}`, {
                    method: 'POST'
                });
                
                if (response.ok) {
                    showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ–¥–æ–±—Ä–µ–Ω–æ', 'success');
                    loadModerator(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫
                } else {
                    showNotification('–û—à–∏–±–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è', 'error');
                }
            } catch (error) {
                console.error('Error approving ad:', error);
                showNotification('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è', 'error');
            }
        };
        
        window.rejectAd = async function(adId) {
            const reason = prompt('–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è:');
            if (!reason) return;
            
            try {
                const response = await fetch(`/api/moderator/reject-ad/${adId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ reason })
                });
                
                if (response.ok) {
                    showNotification('–û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ', 'success');
                    loadModerator(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫
                } else {
                    showNotification('–û—à–∏–±–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è', 'error');
                }
            } catch (error) {
                console.error('Error rejecting ad:', error);
                showNotification('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è', 'error');
            }
        };
        
        // –£—Ç–∏–ª–∏—Ç—ã
        function formatPrice(price) {
            return new Intl.NumberFormat('ru-RU').format(price);
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) return '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
            if (diff < 3600000) return `${Math.floor(diff / 60000)} –º–∏–Ω –Ω–∞–∑–∞–¥`;
            if (diff < 86400000) return `${Math.floor(diff / 3600000)} —á –Ω–∞–∑–∞–¥`;
            if (diff < 604800000) return `${Math.floor(diff / 86400000)} –¥ –Ω–∞–∑–∞–¥`;
            
            return date.toLocaleDateString('ru-RU');
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function getStatusText(status) {
            const statuses = {
                'pending': '–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏',
                'active': '–ê–∫—Ç–∏–≤–Ω–æ',
                'rejected': '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ',
                'sold': '–ü—Ä–æ–¥–∞–Ω–æ'
            };
            return statuses[status] || status;
        }
        
        function showNotification(message, type = 'info') {
            const notifications = document.getElementById('notifications');
            if (!notifications) return;
            
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.style.cssText = `
                background: ${type === 'error' ? '#ff4757' : type === 'success' ? '#00b894' : '#0984e3'};
                color: white;
                padding: 12px 16px;
                border-radius: 8px;
                margin-bottom: 8px;
                display: flex;
                align-items: center;
                gap: 8px;
                animation: slideIn 0.3s ease;
            `;
            notification.innerHTML = `
                <i class="fas fa-${type === 'error' ? 'exclamation-circle' : type === 'success' ? 'check-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            notifications.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        window.testFunction = function() {
            alert('–ö–Ω–æ–ø–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç! JavaScript –∑–∞–≥—Ä—É–∂–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ.');
            console.log('üß™ –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑–≤–∞–Ω–∞!');
        };
        
        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏...');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è - –∑–∞–≥—Ä—É–∂–∞–µ–º –ª–µ–Ω—Ç—É –æ–±—ä—è–≤–ª–µ–Ω–∏–π
            console.log('–ù–∞—á–∏–Ω–∞—é –∑–∞–≥—Ä—É–∑–∫—É –æ–±—ä—è–≤–ª–µ–Ω–∏–π...');
            loadAds();
            
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ç–∞–±–±–∞—Ä—É
            document.querySelectorAll('.tabbar-item').forEach(item => {
                item.addEventListener('click', function() {
                    const tabName = this.dataset.tab;
                    console.log('–ö–ª–∏–∫ –ø–æ —Ç–∞–±–±–∞—Ä—É:', tabName);
                    window.switchTab(tabName);
                });
            });
            
            // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
            document.querySelectorAll('.category-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.category-item').forEach(cat => cat.classList.remove('active'));
                    this.classList.add('active');
                    
                    // –§–∏–ª—å—Ç—Ä—É–µ–º –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                    const category = this.dataset.category;
                    filterAdsByCategory(category);
                });
            });
            
            // FAB –∫–Ω–æ–ø–∫–∞
            const fab = document.querySelector('.fab-button');
            if (fab) {
                fab.addEventListener('click', window.openCreateAd);
            }
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
            document.querySelectorAll('.sort-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    sortAds(this.dataset.sort);
                });
            });
            
            // –ü–æ–∏—Å–∫
            const searchInput = document.querySelector('.search-bar input');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    searchAds(this.value);
                });
            }
            
            console.log('–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã!');
            console.log('–í—Å–µ –≤–∫–ª–∞–¥–∫–∏:', document.querySelectorAll('.tab-content'));
            console.log('–í—Å–µ –∫–Ω–æ–ø–∫–∏ —Ç–∞–±–±–∞—Ä–∞:', document.querySelectorAll('.tabbar-item'));
        });
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function filterAdsByCategory(category) {
            console.log('–§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:', category);
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –æ–±—ä—è–≤–ª–µ–Ω–∏–π
            showNotification(`–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${category}`, 'info');
        }
        
        function sortAds(sortBy) {
            console.log('–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:', sortBy);
            showNotification(`–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: ${sortBy}`, 'info');
        }
        
        function searchAds(query) {
            console.log('–ü–æ–∏—Å–∫:', query);
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∏—Å–∫
        }
        
        window.editProfile = function() {
            showNotification('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
        };
        
        window.openNotifications = function() {
            showNotification('–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
        };
        
        window.openFilters = function() {
            showNotification('–§–∏–ª—å—Ç—Ä—ã –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
        };
        
        window.showNotifications = function() {
            showNotification('–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
        };
    </script>
</body>
</html>
